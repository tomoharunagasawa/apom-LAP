% for user-defined macro
% フォントを変更したつもり 
% \usepackage[dvipdfmx, noto, unicode]{pxchfon}
% \usepackage[deluxe]{luatexja-preset}
% \usepackage[noto,jis2004,unicode]{pxchfon}
% \usepackage[sfdefault]{noto}
\usepackage[T1]{fontenc}
% \usepackage[deluxe,jis2004,expert]{otf}
\renewcommand\kanjifamilydefault{\gtdefault}
\renewcommand\familydefault{\sfdefault}

% ヘッダーの変更
\fancyhead{}% 既存の設定をキャンセル
% \fancyhead[LE]{\gtfamily\sffamily\bfseries\upshape \leftmark}% 左ページなら左側の見出し情報（一般に章名）
% \lhead[\gtfamily\sffamily\bfseries\upshape \leftmark]{}
% \lhead[\gtfamily\sffamily\bfseries\upshape \leftmark]{}
% \rhead[]{\gtfamily\sffamily\bfseries\upshape \rightmark}

% 章見出しの変更

% 字下げをなくす
\setlength{\parindent}{0pt}

% 図の余白をなくす
\setlength\intextsep{0pt}
\setlength\textfloatsep{0pt}

% コラムの見出し:「コラム」と表示しない, 見出し用フォント
\renewcommand{\reviewcolumnhead}[2]{%
{\noindent\headfont #2}}

% 章タイトルの上余白をなくす
\def\@makechapterhead#1{%
  %\vspace*{2\Cvs}% 欧文は50pt
  {\parindent \z@ \raggedright \normalfont
    \ifnum \c@secnumdepth >\m@ne
      \if@mainmatter
        \huge\headfont
		\@chapapp\thechapter\@chappos  
        \par\nobreak
        \vskip \Cvs % 欧文は20pt
      \fi
    \fi
    \interlinepenalty\@M
    \Huge \headfont #1\par\nobreak
    \vskip 1\Cvs}} % 欧文は40pt

\usepackage[x11names]{xcolor}
% セクション（モジュール）
\if@twocolumn
  \renewcommand{\section}{%
    \@startsection{section}{1}{\z@}%
    {0.6\Cvs}{0.4\Cvs}%
    {\normalfont\LARGE\headfont\raggedright\textcolor{yellow!50!black!90!white!30!red}}}
\else
  \renewcommand{\section}{%
    \if@slide\clearpage\fi
    \@startsection{section}{1}{\z@}%
    {\Cvs \@plus.5\Cdp \@minus.2\Cdp}% 前アキ
    {.5\Cvs \@plus.3\Cdp}% 後アキ
    {\normalfont\LARGE\headfont\raggedright\textcolor{white!40!green!55!blue}}}
\fi

% インデントなしの横方向の調整
% \renewcommand{\noindent}
% {\hspace{-0.75\Cvs}}
% インデントなしの横方向の調整
% \newcommand{\noindnt}
% {\hspace{-0.75\Cvs}}
	
% \renewcommand{\section}[block]
% {}{}{0pt}
% {
%   \colorbox{teal}{\begin{picture}(0,20)\end{picture}}
%   \hspace{0pt}
%   \normalfont \Huge\bfseries \thesection
%   \hspace{-4pt}
% }
% [
% \begin{picture}(100,0)
%   \put(3,30){\color{teal}\line(1,0){400}}
% \end{picture}
% \\
% \vspace{-50pt}
% ]



\usepackage[absolute,overlay]{textpos}
\usepackage{pxtextpos}
\newcommand{\myoverlayimage}{
  \begin{textblock*}{85mm}(100mm,\dimexpr\paperheight-7.6mm-2mm)
    % \includegraphics[height=5mm]{images/dasa.png}% 高さ20mmの画像貼り付け
	{©2025 Scrum.org | All Rights Reserved.　|} 
  \end{textblock*}
}
\chead{\myoverlayimage}
\fancypagestyle{plainhead}{% 既存の\fancypagestyle{plainhead}のコピー
\chead{\myoverlayimage}% ここを追加
% \fancyfoot{} % clear all header and footer fields
\fancyfoot[RE,RO]{\thepage}
\renewcommand{\headrulewidth}{0pt}
\renewcommand{\footrulewidth}{0pt}}

% 指定位置に画像を表示する
%% \usepackage{everypage}
% \AddEverypageHook{
%   \myoverlayimage
% }

% % columnの本体デザイン変更
% \renewenvironment{reviewcolumn}[1][]{%
%     \vspace{\baselineskip}
%     \begin{tcolorbox}[breakable, colback=white, colframe=black!40!white, arc=1.5truemm, outer arc=1.8truemm, boxsep=5truemm]
%     \setlength{\parindent}{1zw}%
%     \reviewcolumnhead{}{#1}
%     \vspace{1zw}
%   }{%
%     \end{tcolorbox}
%     \vspace{\baselineskip}
%   }

% 図のキャプションを消す
\renewcommand\reviewimagecaption[1]{%
  \caption*{#1}}


% bothsidelineboxのカスタマイズ
%  - 左右線
\DeclareTColorBox{rv@bothsidelinebox@nocaption}{ O{} }{%
  enhanced,breakable,skin=enhancedmiddle,
  frame hidden,interior hidden,top=0mm,bottom=0mm,boxsep=0mm,
  borderline={0.4mm}{0mm}{black},
%   borderline={0.4mm}{0.4mm}{black!50},
%   borderline={0.4mm}{0.8mm}{black!10},
  before upper={\parindent\reviewtcb@zw{1}},
  fontupper={\userelfont\sffamily\gtfamily}, % 本文をゴシック体にする
  #1}

\DeclareTColorBox{rv@bothsidelinebox@caption}{ m O{} }{%
  enhanced,breakable,skin=enhancedmiddle,
  frame hidden,interior hidden,top=0mm,bottom=0mm,boxsep=0mm,
  borderline={0.4mm}{0mm}{black},
%   borderline={0.4mm}{0.4mm}{black!50},
%   borderline={0.4mm}{0.8mm}{black!10},
  before upper={\parindent\reviewtcb@zw{1}},
  coltitle=black,
  bottomtitle=2mm,
  fonttitle={\reviewtcb@gtfamily\sffamily\bfseries},
  title={#1},
  fontupper={\userelfont\sffamily\gtfamily}, % 本文をゴシック体にする
  #2}

% squarebox
%  - ごくシンプルな矩形
\DeclareTColorBox{rv@squarebox@nocaption}{ O{} }{%
empty, % スキン
left=3mm,right=5mm,top=6mm,bottom=7mm, % 内部パディング。デフォルトは4mm
arc=0mm, % コーナーの半径。デフォルトは1mm
% カラーは 色A!色Aの含み具合!色B。色Bを省略したときにはwhite
colback=white, %white, % 背景。デフォルトはblack!5!white
breakable, % ページ分断の許容
enhanced jigsaw, % 分断時に上下罫線を切り取り
pad at break=5.5mm, % 分断されたときの上下アキ。デフォルトは3.5mm
boxrule=0.0mm, % 線幅。toprule,bottomrule,leftrule,rightruleで個別指定も可
before upper={\setlength{\parindent}{0pt}\noindent\ignorespaces}, % 内容の1行目を字下げしない
fontupper={\userelfont\sffamily\gtfamily}, % 本文をゴシック体にする
#1} % オプション値で追加・上書き可能

\DeclareTColorBox{rv@squarebox@caption}{ m O{} }{%
empty,
left=3mm,right=5mm,top=6mm,bottom=7mm,
arc=0mm,
colback=white,
breakable,
enhanced jigsaw,
pad at break=4.5mm,
boxrule=.25mm,
before upper={\setlength{\parindent}{0pt}\noindent\ignorespaces}, % 内容の1行目を字下げしない
coltitle=black, % キャプション文字色
colbacktitle=white, % キャプション背景
fonttitle={\reviewtcb@gtfamily\sffamily\bfseries},
title={#1},
fontupper={\userelfont\sffamily\gtfamily}, % 本文をゴシック体にする
#2}

% leftsidelinebox
%  - 左線
\DeclareTColorBox{rv@leftsidelinebox@nocaption}{ O{} }{%
  enhanced,breakable,skin=enhancedmiddle,
  frame hidden,interior hidden,top=0mm,bottom=0mm,right=0mm,boxsep=0mm,
  borderline west={0.4mm}{0mm}{black}, % westを付けて左のみにする
%   borderline west={0.4mm}{0.4mm}{black!50},
%   borderline west={0.4mm}{0.8mm}{black!10},
  before upper={\parindent\reviewtcb@zw{1}},
  fontupper={\textsf{\userelfont\sffamily\gtfamily}}, % 本文をゴシック体にする
  #1}

\DeclareTColorBox{rv@leftsidelinebox@caption}{ m O{} }{%
  enhanced,breakable,skin=enhancedmiddle,
  frame hidden,interior hidden,top=0mm,bottom=0mm,right=0mm,boxsep=0mm,
  borderline west={0.4mm}{0mm}{black},
%   borderline west={0.4mm}{0.4mm}{black!50},
%   borderline west={0.4mm}{0.8mm}{black!10},
  before upper={\parindent\reviewtcb@zw{1}},
  coltitle=black,
  bottomtitle=2mm,
  fonttitle={\reviewtcb@gtfamily\sffamily\bfseries},
  title={#1},
  fontupper={\textsf{\userelfont\sffamily\gtfamily}}, % 本文をゴシック体にする
  #2}


% topsidelinebox
%  - 上線
\DeclareTColorBox{rv@topsidelinebox@nocaption}{ O{} }{%
enhanced,breakable,skin=enhancedmiddle,
frame hidden,interior hidden,top=0mm,bottom=3mm,right=2mm,boxsep=1mm,
borderline north={0.2mm}{0mm}{black}, % nouthを付けて上のみにする
borderline south={0.2mm}{0mm}{black}, % southを付けて下のみにする
%   borderline west={0.4mm}{0.4mm}{black!50},
%   borderline west={0.4mm}{0.8mm}{black!10},
before upper={\parindent\reviewtcb@zw{1}},
fontupper={\textsf{\userelfont\sffamily\gtfamily}}, % 本文をゴシック体にする
#1}

\DeclareTColorBox{rv@topsidelinebox@caption}{ m O{} }{%
enhanced,breakable,skin=enhancedmiddle,
frame hidden,interior hidden,top=0mm,bottom=3mm,right=2mm,boxsep=1mm,
borderline north={0.2mm}{0mm}{black}, % nouthを付けて下のみにする
borderline south={0.2mm}{0mm}{black}, % southを付けて下のみにする
%   borderline west={0.4mm}{0.4mm}{black!50},
%   borderline west={0.4mm}{0.8mm}{black!10},
before upper={\parindent\reviewtcb@zw{1}},
coltitle=black,
bottomtitle=2mm,
fonttitle={\textsf{\userelfont\sffamily\gtfamily}},
title={#1},
fontupper={\textsf{\userelfont\sffamily\gtfamily}}, % 本文をゴシック体にする
#2}

% 表の背景色を変える
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{review-custom}[2025/10/20 Table background color only]

\RequirePackage[table]{xcolor}
\RequirePackage{etoolbox}

% 添付の色（Material Blue Grey 200 相当）
\definecolor{ReviewTableBG}{HTML}{C6E6EC}

% 罫線の色はデフォルト（黒）のまま。太さ等は変更しない
% Re:VIEWの //table が内部で使う tabular/longtable に一括適用
\AtBeginEnvironment{tabular}{\rowcolors{1}{ReviewTableBG}{ReviewTableBG}}
\AtBeginEnvironment{longtable}{\rowcolors{1}{ReviewTableBG}{ReviewTableBG}}